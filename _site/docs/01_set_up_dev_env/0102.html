<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Setup an image | Your awesome title</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Setup an image" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="http://localhost:4000/docs/01_set_up_dev_env/0102.html" />
<meta property="og:url" content="http://localhost:4000/docs/01_set_up_dev_env/0102.html" />
<meta property="og:site_name" content="Your awesome title" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Setup an image" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"Setup an image","url":"http://localhost:4000/docs/01_set_up_dev_env/0102.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Your awesome title" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Your awesome title</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/docs/01_set_up_dev_env/0101.html">1. Deploy the necessary prerequisites needed for a Microsoft Dev Box</a><a class="page-link" href="/docs/01_set_up_dev_env/0102.html">2. Setup an image</a><a class="page-link" href="/docs/01_set_up_dev_env/0103.html">3. Deploy a Microsoft Dev Box</a><a class="page-link" href="/docs/01_set_up_dev_env/01_set_up_development_environment.html">Exercise 01: Set up development environment</a><a class="page-link" href="/docs/02_start_working_github/0201.html">1. Set up a GitHub repository</a><a class="page-link" href="/docs/02_start_working_github/0202.html">2. Track your work</a><a class="page-link" href="/docs/02_start_working_github/0203.html">3. Set up a GitHub Actions workflow</a><a class="page-link" href="/docs/02_start_working_github/02_start_working_in_github.html">Exercise 02: Start working in GitHub</a><a class="page-link" href="/docs/03_improve_deploy_app/0301.html">1. Configure Microsoft Copilot on your Dev Box</a><a class="page-link" href="/docs/03_improve_deploy_app/0302.html">2. Change the application</a><a class="page-link" href="/docs/03_improve_deploy_app/0303.html">3. Introduce infrastructure as code</a><a class="page-link" href="/docs/03_improve_deploy_app/0304.html">4. Build, Push, and Deploy Changes</a><a class="page-link" href="/docs/03_improve_deploy_app/03_improve_and_deploy_your_application.html">Exercise 03: Improve and deploy your application</a><a class="page-link" href="/docs/04_implement_load_testing/0401.html">1. Configure Microsoft Copilot on your Dev Box</a><a class="page-link" href="/docs/04_implement_load_testing/0402.html">2. Run a load test from GitHub Actions</a><a class="page-link" href="/docs/04_implement_load_testing/0403.html">3. Identifying bottlenecks, stress tests, and resilience testing</a><a class="page-link" href="/docs/04_implement_load_testing/04_implement_load_testing_and_secure_practices.html">Exercise 04: Implement load testing and secure practices</a><a class="page-link" href="/docs/05_make_things_secure/0501.html">1. Configure Microsoft Copilot on your Dev Box</a><a class="page-link" href="/docs/05_make_things_secure/0502.html">2. Ensure your code is secure</a><a class="page-link" href="/docs/05_make_things_secure/0503.html">3. Monitoring with Application Insights</a><a class="page-link" href="/docs/05_make_things_secure/05_make_things_secure.html">Exercise 05: Make things secure</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h1 id="task-02---setup-an-image-90-minutes">Task 02 - Setup an image (90 minutes)</h1>

<h2 id="description">Description</h2>

<p>Typically, when a developer needs to have an environment configured for their development tasks, they need software deployed, specific versions of tools and source code, any other configurations for their development tasks. This can be a time-consuming process, particularly when onboarding a new developer or switching to a new development project.</p>

<p>If developers are working on multiple projects, they may even have challenges with those different projects requiring different versions of the same software. In this task, you’ll setup an image to be used for Dev Box. This enables most of these things to be preconfigured so as soon as a user is onboarded or needs to work on a different project, an environment can be quickly spun up for them from an image.</p>

<ol>
  <li>Create a compute gallery &amp; add it to the Dev center</li>
  <li>
    <p>Create a custom image using Windows 11 Enterprise, version 22H2 - x64 Gen2</p>

    <blockquote class="note">
      <p>Make sure you select enterprise and not pro. Pro is not supported for Dev Box.</p>
    </blockquote>
  </li>
  <li>Include the following software on the custom image. If you have any issues selecting and copying the link you can also right click the link and select “Copy Link”.
    <ul>
      <li>Docker (without WSL)
        <ul>
          <li><a href="https://docs.docker.com/desktop/install/windows-install/">https://docs.docker.com/desktop/install/windows-install/</a></li>
        </ul>

        <blockquote class="note">
          <p>Make sure to UNCHECK to use WSL during installation. This will cause issue with docker</p>
        </blockquote>
      </li>
      <li>Visual Studio Code (System Installer):
        <ul>
          <li><a href="https://code.visualstudio.com/Download">https://code.visualstudio.com/Download</a></li>
          <li>Make sure this finishes before installing Git so you can set it as the default editor</li>
        </ul>
      </li>
      <li>Java (for JMeter):
        <ul>
          <li><a href="https://www.java.com/en/download/">https://www.java.com/en/download/</a></li>
        </ul>
      </li>
      <li>Apache JMeter:
        <ul>
          <li><a href="https://dlcdn.apache.org//jmeter/binaries/apache-jmeter-5.6.2.zip">https://dlcdn.apache.org//jmeter/binaries/apache-jmeter-5.6.2.zip</a></li>
          <li>Extract the apache-jmeter-5.6.2 folder to C:\</li>
        </ul>
      </li>
      <li>Azure Storage Explorer (Install for all users):
        <ul>
          <li><a href="https://azure.microsoft.com/products/storage/storage-explorer/">https://azure.microsoft.com/products/storage/storage-explorer/</a></li>
        </ul>
      </li>
      <li>Git bash:
        <ul>
          <li><a href="https://git-scm.com/download/win">https://git-scm.com/download/win</a></li>
          <li>64bit git for Windows Setup</li>
          <li>You may want to set the default editor to VSCode, keep the defaults for everything else.</li>
        </ul>
      </li>
      <li>.NET SDK 6.0 LTS:
        <ul>
          <li><a href="https://dotnet.microsoft.com/download/visual-studio-sdks">https://dotnet.microsoft.com/download/visual-studio-sdks</a></li>
          <li>.NET 6.0 x64 Visual Studio 2022 SDK</li>
        </ul>
      </li>
      <li>Firefox:
        <ul>
          <li><a href="https://www.mozilla.org/en-US/firefox/new/">https://www.mozilla.org/en-US/firefox/new/</a>.</li>
          <li>Firefox is useful because it allows you to create a manual proxy rather than using Windows defaults, as Chrome and Edge require. This will be helpful in Exercise 4.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Reboot after installing all of the software and ensure that Docker is running before performing a sysprep.</p>

    <blockquote class="important">
      <p>At this point in time, take a snapshot of the OS disk on your VM so you can make updates to it later if needed. Once you sysprep a VM you can’t boot it back up again to make changes.</p>
    </blockquote>
  </li>
  <li>Perform sysprep. To do so:
    <ul>
      <li>Delete C:\Windows\Panther and empty the recycle bin</li>
      <li>In the command prompt, CD to C:\Windows\System32\SysPrep and run <code class="language-plaintext highlighter-rouge">sysprep.exe /oobe /generalize /shutdown</code></li>
    </ul>
  </li>
  <li>Create the new image
    <ul>
      <li>For the VM image definition, create a new one with the name “DevBoxProject” and leave everything else as default</li>
      <li>VM version number can be 1.0.0</li>
      <li>Default storage SKU: Premium SD LRS</li>
      <li>Review + create –&gt; Create</li>
    </ul>
  </li>
</ol>

<blockquote class="important">
  <p>It can take anywhere from 20 minutes to an hour to create the image. If it still hasn’t completed after 15 or 20 minutes. You can start on Exercise 2 using a different machine. Task 3 of exercise 1 depends on the completely of this image creating.  It is ok to use your own computer for Day 1 and use the Dev Box on day 2.</p>
</blockquote>

<h2 id="success-criteria">Success Criteria</h2>

<ul>
  <li>You have created a compute gallery and added it to the Dev center.</li>
  <li>You have created a custom image with all relevant software installed.</li>
</ul>

<h2 id="learning-resources">Learning Resources</h2>

<ul>
  <li><a href="https://learn.microsoft.com/en-us/azure/virtual-machines/create-gallery?tabs=portal%2Cportaldirect%2Ccli2">Create an Azure Compute gallery</a></li>
  <li><a href="https://learn.microsoft.com/azure/dev-box/quickstart-configure-dev-box-service?tabs=AzureADJoin#3-create-a-dev-box-definition">Create a Dev Box Definition</a></li>
  <li><a href="https://learn.microsoft.com/azure/virtual-machines/generalize">Generalize a VM</a></li>
  <li><a href="https://learn.microsoft.com/azure/virtual-machines/capture-image-portal">Create an image from a VM</a></li>
</ul>

<h2 id="tips">Tips</h2>

<ul>
  <li>For the image creation, use the VM Size: Standard D4s v3 (4 vCPUs, 16 GiB memory) with a Windows 10 or 11 Image</li>
  <li>After running sysprep on a virtual machine in Azure, you can’t use it again, so you can delete the VM along with it’s associated resources (NIC, Disk, etc.)</li>
  <li>For security, once you create the VM with RDP access, go into the networking settings and set the RDP access Source to be limited to your IP address</li>
  <li>If you do need to make changes to your VM after you ran sysprep, you’ll need to restore from the snapshot
    <ol>
      <li>Create a new disk from the snapshot</li>
      <li>Create a new VM from the new managed disk</li>
      <li>Make your updates on the VM</li>
      <li>Create a new snapshot</li>
      <li>Run sysprep again.</li>
    </ol>
  </li>
</ul>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Your awesome title</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Your awesome title</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
